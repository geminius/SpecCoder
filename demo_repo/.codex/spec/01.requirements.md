# Requirements

## Product Vision
Provide a minimal API-driven service that enables core auth flows and simple reporting exports for our primary personas (Data Analyst, Support Agent), focusing on speed, reliability, and clear observability.

## STORY-001 — Password Reset via Email
---
id: STORY-001
type: story
status: done
priority: P1
depends_on: []
component_tags: ['auth', 'api', 'notify']
tasks_generated: true
story_fingerprint: "sha256:b2e05a12a67f7f7f35f6da5e6f71750a0c0f4a1c2b273c51d66706f479fc6be6"
kind: feature
---
### Motivation
Users forget passwords and need a simple, self-serve recovery flow.

### Acceptance
- POST /v1/auth/reset accepts {email} JSON and returns 200 with {ok: true}
- If email is malformed → 400
- Emits audit event `auth.reset.requested`
- Rate-limit: 5/min per IP

### NFR
- API p95 ≤ 200ms; errors logged

## STORY-002 — Export reports as CSV
---
id: STORY-002
type: story
status: ready
priority: P2
depends_on: []
component_tags: ['reporting', 'api']
tasks_generated: false
story_fingerprint: "sha256:4e6875acfa96dfb5f3a6a030a1b7fb3b01b9d92737d2c24fee589fe3a3e1c5a6"
kind: feature
---
### User Story
As a Data Analyst, I want to export a report as CSV so that I can analyze it in my spreadsheet tool.

### Motivation
Enable quick data export for offline analysis and sharing.

### Acceptance
- GET /v1/reports/{id}/export?format=csv returns 200 and a CSV file download
- Content-Type: text/csv; charset=UTF-8; filename includes report title and date
- Encoding: UTF-8; values properly quoted; headers on first row
- Max rows: 50,000; if exceeded → 413 with message "export limit exceeded"
- Permissions: only users with role Analyst or above can export; others → 403
- Invalid report id → 404
- Emits audit event `reports.export.requested` with report id and requester
- Observability: counter metric `reports_export_csv_total` and latency histogram

### NFR
- API p95 ≤ 200ms for 10k rows; streaming or chunking allowed
- No PII leakage; respect column-level permissions

### Out of Scope
- XLSX/XLS formats

### Outcome Measures (optional)
- KPI/metric: percentage of reports exported successfully
- Baseline/target: baseline unknown; target ≥ 95% success rate
